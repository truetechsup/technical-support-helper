#!/usr/bin/env python3
"""
Скрипт для инициализации БД и добавления тестовых данных
"""
import uuid
from database import init_db, add_error

def add_test_data():
    """Добавляет тестовые данные в БД"""
    
    # Инициализируем БД
    print("Инициализация БД...")
    init_db()
    print("БД инициализирована!")
    
    # Тестовые данные
    test_errors = [
        {
            'uuid': str(uuid.uuid4()),
            'error': 'Connection timeout',
            'description': 'Ошибка возникает при попытке подключения к серверу, когда сервер не отвечает в течение установленного времени ожидания. Обычно происходит при проблемах с сетью или перегрузке сервера.',
            'solution': '1. Проверьте сетевое подключение\n2. Увеличьте таймаут подключения в настройках\n3. Проверьте доступность сервера командой ping\n4. Обратитесь к системному администратору',
            'tickets': ['TICKET-12345', 'TICKET-67890'],
            'tasks': ['https://jira.example.com/TASK-001']
        },
        {
            'uuid': str(uuid.uuid4()),
            'error': '404 Not Found',
            'description': 'Страница или ресурс не найден на сервере. Может возникать при неправильном URL или удаленном ресурсе.',
            'solution': '1. Проверьте правильность URL адреса\n2. Убедитесь, что ресурс существует\n3. Проверьте права доступа\n4. Очистите кэш браузера',
            'tickets': ['TICKET-11111'],
            'tasks': []
        },
        {
            'uuid': str(uuid.uuid4()),
            'error': 'Permission denied',
            'description': 'Отказ в доступе. Пользователь не имеет прав для выполнения данного действия.',
            'solution': '1. Проверьте права доступа пользователя\n2. Обратитесь к администратору для предоставления прав\n3. Убедитесь, что используете правильную учетную запись',
            'tickets': ['TICKET-22222', 'TICKET-33333'],
            'tasks': ['https://jira.example.com/TASK-002', 'https://jira.example.com/TASK-003']
        }
    ]
    
    # Добавляем тестовые данные
    print("\nДобавление тестовых данных...")
    for error_data in test_errors:
        if add_error(error_data):
            print(f"✓ Добавлена ошибка: {error_data['error']}")
        else:
            print(f"✗ Ошибка при добавлении: {error_data['error']}")
    
    print("\nГотово! Тестовые данные добавлены.")

if __name__ == '__main__':
    add_test_data()

